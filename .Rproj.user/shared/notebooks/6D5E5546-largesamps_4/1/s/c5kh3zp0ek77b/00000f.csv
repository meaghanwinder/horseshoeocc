"0","reg_hs_tau0_p0unif <- function(){"
"0","  # likelihood"
"0","  for(i in 1:nrow_site_df){"
"0","    logit(psi[i]) <- beta0 + inprod(beta[1:D], x[i, 1:D])"
"0","    z[i] ~ dbern(psi[i])"
"0","    y[i] ~ dbin(p*z[i], nsamp[i])"
"0","  }"
"0","  "
"0","  ## p0_uniform"
"0","  p0 ~ dunif(1, D - 1) "
"0","  "
"0","  # compute quantities for hyper prior on tau"
"0","  tau0 <- p0/(D-p0) * sqrtpseudovar / (sqrtnsite)"
"0","  tau02 <- tau0 * tau0"
"0","  "
"0","  # priors"
"0","  beta0 ~ dnorm(0, 1/2) # intercept"
"0","  p ~ dbeta(1, 1)"
"0","  "
"0","  tau ~ dt(0, 1/tau02, 1);T(0,) # global shrinkage"
"0","  tau2 <- tau*tau"
"0","  c2.rep ~ dgamma(df.slab/2, scale.slab^2*df.slab/2) "
"0","  c2 <- 1/c2.rep"
"0","  "
"0","  for(j in 1:D){"
"0","    lambda[j] ~ dt(0, 1, 1);T(0,)"
"0","    lambda2[j] <- lambda[j]*lambda[j]"
"0","    lambdat[j] <- (c2 * lambda2[j])/(c2 + tau2 * lambda2[j])"
"0","    lambda2t[j] <- lambdat[j] * lambdat[j]"
"0","    beta[j] ~ dnorm(0, 1/(tau2 * lambda2t[j]))"
"0","  }"
"0","  "
"0","  # calculate shrinkage factor"
"0","  b <- 1/(1 + nrow_site_df * 1/pseudovar * c2)"
"0","  "
"0","  for(j in 1:D){"
"0","    kappa[j] <- 1/(1 + nrow_site_df * 1/pseudovar * tau2 * 1 * lambda2[j])  "
"0","    kappat[j] <- (1-b)*kappa[j] + b"
"0","  }"
"0","  meff <- sum(1 - kappa[1:D])"
"0","  mefft <- (1-b)*meff"
"0","}"
"0",""
"0","set.seed(4)"
"0","init_hs100 <- function(){"
"0","  list("
"0","    p = 0.9, "
"0","    beta0 = 0,"
"0","    beta = rep(0, 100),"
"0","    lambda = rep(1, 100),"
"0","    tau = .05,"
"0","    c2.rep = 1, "
"0","    z = rep(1, nsite)"
"0","  )"
"0","}"
"0",""
"0","fit <- jags.parallel("
"0","  model.file = reg_hs_tau0_p0unif,"
"0","  n.chains = 3,"
"0","  inits = init_hs100,"
"0","  data = list("
"0","    nsite = nrow(sim_data100$df),"
"0","    D = ncol(sim_data100$x),"
"0","    x = sim_data100$x,"
"0","    nrow_site_df = nrow(sim_data100$df), "
"0","    y = sim_data100$df$det,"
"0","    df.slab = 4,"
"0","    scale.slab = 2, "
"0","    sqrtpseudovar = sqrt(4),"
"0","    pseudovar = 4, "
"0","    sqrtnsite = sqrt(nrow(sim_data100$df)), "
"0","    nsamp = sim_data100$df$nsamp"
"0","  ),"
"0","  n.iter = 250000,"
"0","  n.burnin = 125000,"
"0","  n.thin = 5,"
"0","  parameters.to.save = c(""p"", ""beta0"", ""beta"", ""tau"", ""lambdat"", ""kappat"", ""mefft""),"
"0","  jags.seed = 1,"
"0","  jags.module = c(""glm"")"
"0",")"
"0",""
"0","saveRDS(convert_to_list(fit), file = ""sim_reghs_unif_100.rds"")"
